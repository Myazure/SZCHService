<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.milestone.mygeo.dao.ILayoutAreaDao">
    
    <insert id="insertLayoutArea" parameterType="LayoutArea">
     insert into layout_area(father_layout,area_color) 
            values(#{father_layout},#{area_color}) 
        <selectKey keyProperty="area_id" resultType="int" order="AFTER" >
			SELECT LAST_INSERT_ID()
		</selectKey>  
	</insert>
	

	<insert id="addAreaParamList" useGeneratedKeys="true" parameterType="java.util.List">  
	     
	    insert into area_param (father_area, param_name, param_code ,param_type, is_input, is_select, is_must, is_light, is_memory, remark, param_length, father_param, is_operate,order_num)   
	    values  
	    <foreach collection="list" item="AreaParam" index="index" separator="," >  
	        (#{AreaParam.father_area}, #{AreaParam.param_name}, #{AreaParam.param_code}, #{AreaParam.param_type}, #{AreaParam.is_input}, #{AreaParam.is_select}, #{AreaParam.is_must}, #{AreaParam.is_light}, #{AreaParam.is_memory}, #{AreaParam.remark}, #{AreaParam.param_length}, #{AreaParam.father_param}, #{AreaParam.is_operate}, #{AreaParam.order_num})
	    </foreach>  
	</insert> 	
	
	
	<update id="updateLayoutArea" parameterType="LayoutArea" >  
	    update layout_area  
	    <set >  
	      <if test="area_color != null" >  
	        area_color = #{area_color},  
	      </if>              
	    </set>  
	    where area_id = #{area_id}  
	</update>
	
	
	<select id="selectAreaByLayout"  resultType="LayoutArea" parameterType="int">
		select * from layout_area where father_layout = #{father_layout} and is_del=0
    </select>
	
	
	<select id="getAreaParams"  resultType="AreaParam" parameterType="AreaParam">
		select * from area_param where father_area = #{father_area} and (param_name = #{param_name} or param_code = #{param_code}) and is_del=0
    </select>
    
    
    <insert id="addAreaParam"  parameterType="AreaParam">  
	     
	    insert into area_param (father_area, param_name, param_code ,param_type, is_input, is_select, is_must, is_light, is_memory, remark, param_length, father_param,is_operate,order_num)   
	    	values  (#{father_area}, #{param_name}, #{param_code}, #{param_type}, #{is_input}, #{is_select}, #{is_must}, #{is_light}, #{is_memory}, #{remark}, #{param_length}, #{father_param}, #{is_operate}, #{order_num})
 		<selectKey keyProperty="area_paramid" resultType="int" order="AFTER" >
			SELECT LAST_INSERT_ID()
		</selectKey> 
	</insert> 
	
	<update id="updateAreaParam" parameterType="AreaParam" >  
	    update area_param  
	    <set >  
	      <if test="param_name != null" >  
	        param_name = #{param_name},  
	      </if>   
	      <if test="param_code != null" >  
	        param_code = #{param_code},  
	      </if>    
	      param_type = #{param_type},  
	      is_input = #{is_input},  
	      is_select = #{is_select},  
	      is_must = #{is_must},
	      is_light = #{is_light},  
	      is_memory = #{is_memory},  
	      remark = #{remark},  
	      param_length = #{param_length},     
	      father_param = #{father_param},       
	    </set>  
	    where area_paramid = #{area_paramid}  
	</update>
	
	
	<select id="getAreaParamsByArea"  resultType="AreaParam" parameterType="int">
		select * from area_param where father_area = #{father_area} and is_del=0 order by order_num
    </select>
    
    
    
    <insert id="addAreaParamSet" parameterType="AreaParamSet">
     insert into area_param_set(area_paramid,name,value) 
            values(#{area_paramid},#{name},#{value}) 
        <selectKey keyProperty="id" resultType="int" order="AFTER" >
			SELECT LAST_INSERT_ID()
		</selectKey>  
	</insert>
    
	
    <update id="updateAreaParamSet" parameterType="AreaParamSet" >  
	    update area_param_set  
	    <set >  
	      <if test="name != null" >  
	        name = #{name},  
	      </if>   
	      <if test="value != null" >  
	        value = #{value},  
	      </if>              
	    </set>  
	    where id = #{id}  
	</update>
	
		
	<select id="getAreaParamSetsByParamId"  resultType="AreaParamSet" parameterType="int">
		select * from area_param_set where area_paramid = #{area_paramid} and is_del=0
    </select>
    
    <select id="getAreaParamByParamId"  resultType="AreaParam" parameterType="int">
		select * from area_param where area_paramid = #{area_paramid} and is_del=0
    </select>
    
    <update id="deleteAreaParamSetById"  parameterType="int" >
		update area_param_set set is_del=1 where id = #{id} 
    </update>
    
	<update id="deleteAreaParamByParamId"  parameterType="int" >
		update area_param set is_del=1 where area_paramid = #{area_paramid} 
    </update>
    
    <update id="deleteAreaParamSetByParamId"  parameterType="int" >
		update area_param_set set is_del=1 where area_paramid = #{area_paramid} 
    </update>
    
    <update id="deleteAreaByAreaId"  parameterType="int" >
		update layout_area set is_del=1 where area_id = #{area_id} 
    </update>
    
    <update id="updateAreaParamOrderUp"  parameterType="AreaParam" >
		update area_param set order_num = order_num-1 where father_area = #{father_area} and is_del=0 and order_num > #{order_num} 
    </update>
    
    <update id="updateAreaParamOrder"  parameterType="AreaParam" >
		update area_param set order_num = #{order_num} where area_paramid = #{area_paramid} 
    </update>
    
</mapper>

